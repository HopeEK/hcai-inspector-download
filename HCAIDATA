import requests
import pandas as pd

# Placeholder for the Tableau export endpoint URL
# Replace this with the actual URL you obtain from the HCAI dashboard
endpoint_url = "https://your-tableau-export-endpoint.csv"

# File names for saving the data
csv_filename = "inspectors.csv"
excel_filename = "inspectors.xlsx"

def download_inspector_data(url, csv_path, excel_path):
    """
    Downloads the inspector list from the given Tableau export endpoint,
    saves it as a CSV file, and converts it to Excel format.
    """
    try:
        # Send GET request to download the CSV data
        response = requests.get(url)
        response.raise_for_status()  # Raise an error for bad status codes

        # Save the content to a CSV file
        with open(csv_path, "wb") as f:
            f.write(response.content)
        print(f"CSV file saved as {csv_path}")

        # Load the CSV into a DataFrame
        df = pd.read_csv(csv_path)

        # Save the DataFrame to an Excel file
        df.to_excel(excel_path, index=False)
        print(f"Excel file saved as {excel_path}")

    except requests.exceptions.RequestException as e:
        print(f"Error downloading data: {e}")
    except Exception as e:
        print(f"Error processing data: {e}")

# Run the function with the placeholder URL
download_inspector_data(endpoint_url, csv_filename, excel_filename)
